<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="M2 IGAST" />
  <title>Analyse Bivariée</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="CoursBivariee_PC_files/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="CoursBivariee_PC_files/reveal.js-3.3.0.1/css/theme/sky.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="style.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">Analyse Bivariée</h1>
    <h2 class="author">M2 IGAST</h2>
    <h3 class="date">2020-2021</h3>
</section>

<section><section id="introduction-rappels" class="titleslide slide level1"><h1>Introduction &amp; Rappels</h1></section><section id="sources-et-reférences" class="slide level2">
<h2>Sources et Reférences</h2>
<ul>
<li>Ce cours reprend le cheminement du cours M2 IGAST 2017 d'Élodie Buard</li>
<li>R et espace <a href="https://framabook.org/r-et-espace/" class="uri">https://framabook.org/r-et-espace/</a></li>
<li>Probabilités, analyse de données et statistiques , Gilbert Saporta, Editions TECHNIP, 2011</li>
<li>Nombreuses ressources en ligne : <a href="http://www.foad-mooc.auf.org/IMG/pdf/424B_-Application_des_methodes_statistiques_d_analyse.pdf" class="uri">http://www.foad-mooc.auf.org/IMG/pdf/424B_-Application_des_methodes_statistiques_d_analyse.pdf</a></li>
<li>et wikipedia !</li>
</ul>
</section><section id="rappel-deux-familles-statistiques" class="slide level2">
<h2>Rappel : Deux familles statistiques</h2>
<h3 id="statistiques-inférentielles">Statistiques <strong>inférentielles</strong></h3>
<p><br> Pour répondre à la question : «A partir d'un échantillon , que peut-on attendre (inférer) de la population ?» <br></p>
<ul>
<li>Modèles, estimateurs, ... : <strong>régression</strong>, <strong>estimation</strong>, <strong>extrapolation</strong></li>
<li><em>Liaisons</em> statistiques : <strong>corrélation</strong>, <strong>covariance</strong></li>
<li>test statistiques, notions de probabilités</li>
<li>e.g. sondages, rencensement, intervalle de confiance , prédictions, ...</li>
</ul>
</section><section id="rappel-deux-familles-statistiques-1" class="slide level2">
<h2>Rappel : Deux familles statistiques</h2>
<h3 id="statistiques-descriptives">Statistiques <strong>descriptives</strong></h3>
<p><br> Pour <strong>résumer</strong>, <strong>synthétiser</strong>, rendre intelligible, les propriétés d'une <strong>population</strong> à partir des <strong>variables</strong> qui décrivent les individus et la <strong>répartition</strong> de leurs valeurs. <br></p>
<ul>
<li>Graphiques (histogrammes, boxplots, )</li>
<li>Mesures (fréquences , distributions , moments)</li>
<li>classification, ACP,...</li>
</ul>
</section><section id="rappel-vocabulaire" class="slide level2">
<h2>Rappel : Vocabulaire</h2>
<p><br> <strong>Population</strong> : Ensemble d'individus</p>
<p>&quot;données&quot;, &quot;corpus&quot;, &quot;échantillon&quot;, &quot;data&quot; <br></p>
<p><strong>Individu</strong> : Unité statistique <strong>élémentaire</strong> = «les lignes du tableau»</p>
<p><strong>Variables </strong> : Caractéristiques, propriétés d’un individu, <strong>mesurées</strong> par des enquêtes, des observations,... = «les colonnes du tableau»</p>
</section><section id="lobjet-du-cours-l-analyse-bivariée" class="slide level2">
<h2>L'objet du cours : l' Analyse Bivariée</h2>
<p>Objectif : <strong>Analyser</strong> le <strong>lien</strong> entre deux variables, par exemple :</p>
<p><strong>lien entre deux variables quantitatives</strong></p>
<p><font size=4> &quot;nombre d'habitants et nombre de lignes de bus par département&quot;</p>
<p>&quot;nombre de lignes de bus en 1998 et en 2018&quot;<br />
</font></p>
<p><strong>lien entre deux variables qualitatives</strong></p>
<p><font size=4> &quot;couleur des yeux et port de lunettes&quot; </font></p>
<p><strong>lien entre une variable quantitative, une variable qualitative</strong></p>
<p><font size=4> &quot;taille et couleur des yeux&quot;<br />
</font></p>
</section><section id="mise-en-garde" class="slide level2">
<h2>Mise en garde</h2>
<p><span style="color:red"> Une liaison, même très forte, entre deux variables, n'indique pas la causalité! ⚠</span></p>
<p>Erreur très courrante, très tentante.</p>
<p><img src="chart.svg"/></p>
<p>© TylerVigen <a href="http://tylervigen.com/spurious-correlations" class="uri">http://tylervigen.com/spurious-correlations</a></p>
</section><section id="analyse-bivariée-avec-des-données-spatiales" class="slide level2">
<h2>Analyse bivariée avec des données spatiales</h2>
<h3 id="données-spatiales">Données spatiales</h3>
<ul>
<li>Individus restreints spatialement (selection spatiale)</li>
<li>variables &quot;géographique &quot; (e.g. lieu de résidence) renseignées pour les individus</li>
</ul>
<p>prise en compte des <strong>distances</strong> ? <span class="math inline">\(\rightarrow\)</span> modèle gravitaire</p>
<h3 id="données-localisées">Données localisées</h3>
<ul>
<li>Auto-corrélation spatiale (Moran's I)</li>
<li>Geographicaly Weightd Regression (GWR) <span class="math inline">\(\approx\)</span> regression linéaire avec prise en compte de la distance entre individus</li>
</ul>
</section></section>
<section><section id="régression-linéaire" class="titleslide slide level1"><h1>Régression linéaire</h1></section><section id="première-étape" class="slide level2">
<h2>Première étape</h2>
<p><span style="color:red">Toujours en premier:</span> Regarder l'aspect des données avec des graphiques (&quot;exploration visuelle&quot;)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="kw">plot</span>(iris)</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/plotIris-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Existe-t-il un lien entre des variables ?</p>
</section><section id="diverses-formes-des-dépendances" class="slide level2">
<h2>Diverses formes des dépendances</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/formes-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>En pratique les formes sont beaucoup moins régulières.</p>
</section><section id="les-étapes" class="slide level2">
<h2>Les étapes</h2>
<ol type="1">
<li>Tracer le nuage de points</li>
<li>Existe-t-il une relation ?</li>
<li>Est-elle de forme linéaire ? De quel sens ?</li>
<li>Si la liaison est de forme linéaire <span class="math inline">\(\rightarrow\)</span> faire une <strong>régression</strong></li>
<li>Si la liaison est non linéaire, est-elle monotone ? De forme connue ?<span class="math inline">\(\rightarrow\)</span> Proposer un <strong>modèle</strong></li>
</ol>
<p>5bis. Réaliser un modèle <strong>LOESS</strong> avec prudence (uniquement descriptif , aucun pouvoir de généralisation)</p>
<p>cf le blog de Lise Vaudor [<a href="http://perso.ens-lyon.fr/lise.vaudor/regression-loess/" class="uri">http://perso.ens-lyon.fr/lise.vaudor/regression-loess/</a>]</p>
</section><section id="régression-linéaire-1" class="slide level2">
<h2>Régression linéaire</h2>
<p>Si la forme du nuage de points s'y prête, on peut faire une <strong>régression linéaire</strong> (aussi appelé <strong>ajustement</strong> linéaire).</p>
<p>On cherche la droite qui «passe au mieux» (=<em>ajustée</em>) dans le nuage de points de deux variables quantitatives <span class="math inline">\(V_1\)</span> et <span class="math inline">\(V_2\)</span>, qui permet de vsiualiser:</p>
<ul>
<li>l'<strong>intensité</strong> du lien / de la dépendance : points proche de la droite ou non ?</li>
<li>la <strong>forme</strong> de la dépendance : linéaire ou non ?</li>
<li>le <strong>sens</strong> de la dépendance : nulle, positive ou négative ?</li>
</ul>
</section><section id="régression-linéaire-2" class="slide level2">
<h2>Régression linéaire</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/regline-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>«Droite qui passe au mieux» = qui minimise la <strong>somme des écarts quadratiques</strong> entre la droite et les points du nuage.</p>
</section><section id="régression-linéaire-le-modèle" class="slide level2">
<h2>Régression linéaire : le modèle</h2>
<p>L'<strong>équation</strong> de la droite est un <strong>modèle linéaire</strong> de la relation statistique qui lie <span class="math inline">\(V_1\)</span> et <span class="math inline">\(V_2\)</span>;</p>
<p>Ici le modèle est : <span class="math inline">\(\hat{V_2}=aV_1+b\)</span></p>
<p><br />
Si la régression linéaire est avérée, alors pour un individu <span class="math inline">\(i\)</span> dont on connait <span class="math inline">\(V1_i\)</span>, on infère la valeur <span class="math inline">\(V2_i\)</span> par le modèle : <span class="math inline">\(\hat{V_{2i}} = aV_{1i} +b\)</span></p>
<p>On dit aussi que <span class="math inline">\(V_1\)</span> <strong>explique</strong> <span class="math inline">\(V_2\)</span> , ou que le modèle <strong>prédit</strong> <span class="math inline">\(V_2\)</span> à partir de <span class="math inline">\(V_1\)</span> (on note les valeurs prédites <span class="math inline">\(\hat{V_2}\)</span>)</p>
</section><section id="la-grande-question" class="slide level2">
<h2>La grande question</h2>
<p>Comment déterminer qu'une régression linéaire est «correcte» ?</p>
</section><section id="comment-evaluer-la-validité-du-modèle-linaire" class="slide level2">
<h2>Comment evaluer la &quot;validité&quot; du modèle linaire ?</h2>
<p>En pratique, il faut réunir deux critères :</p>
<ul>
<li>des coefficients avec des <strong>p-values</strong> associées <strong>faibles</strong> (e.g. &lt;0.05) <span class="math inline">\(\leftrightarrow\)</span> &quot;on a peu de chances de se tromper&quot;</li>
<li>un <span class="math inline">\(R^2\)</span> élevé <span class="math inline">\(\leftrightarrow\)</span> &quot;le modèle prédit bien les observations&quot;</li>
</ul>
</section><section id="le-r2" class="slide level2">
<h2>le <span class="math inline">\(R^2\)</span></h2>
<p><span class="math inline">\(R^2 \in [0;1]\)</span> , c'est le <strong>coefficient de détermination linéaire</strong>.</p>
<p>Donne la <strong>qualité de prédiction</strong> de la régression.</p>
<p>&quot;Proche de 1&quot;&quot; <span class="math inline">\(\equiv\)</span> &quot;très bonne qualité&quot;</p>
<p>C'est le pourcentage de &quot;variation&quot; de <span class="math inline">\(V_2\)</span> due à la &quot;variation&quot; de <span class="math inline">\(V_1\)</span></p>
</section><section id="le-r2-1" class="slide level2">
<h2>le <span class="math inline">\(R^2\)</span></h2>
<p>défini par : <span class="math inline">\(R^2 = 1 - \frac{\sum_{i=1}^{n} (y_i - \hat{y})^2}{\sum_{i=1}^{n} (y_i - \bar{y})^2}\)</span></p>
<p>si on note <span class="math inline">\(\hat{V_2}\)</span> les valeurs de <span class="math inline">\(V_2\)</span> prédite par le modèle linéaire, alors:</p>
<p><span class="math inline">\(R^2=cor(\hat{V_2},V_2)^2\)</span></p>
<p>(au sens de la corrélation de Pearson)</p>
</section><section id="la-p-value" class="slide level2">
<h2>la p-value</h2>
<p>Elle peut s'interpréter comme «la probabilité d'avoir un résultat de regression identique avec deux variables véritablement indépendantes»</p>
<p><br> <br></p>
<p>La p-value est associée à la notion d'<strong>hypothèses nulle</strong>. Ici , l'hypothèse nulle est &quot;les deux séries sont indépendantes&quot;.</p>
</section><section id="la-p-value-1" class="slide level2">
<h2>la p-value</h2>
<p>Plus grossièrement : la p-value est le <strong>pourcentage de chances de se tromper</strong> en rejetant l'hypothèse nulle,</p>
<p><br> c'est à dire <br></p>
<p>se tromper en considérant que les deux séries ne sont pas indépendantes et qu'il existe une relation entre les deux (ici, linéaire car nous testons un modèle linéaire).</p>
</section><section id="lhypothèse-nulle" class="slide level2">
<h2>l'Hypothèse nulle</h2>
<p><span class="math inline">\(H_0\)</span> : «les deux variables sont indépendantes»</p>
<ul>
<li><strong>conserver</strong> <span class="math inline">\(H_0\)</span> : considérer les deux variables comme <strong>indépendantes</strong></li>
<li><strong>rejeter</strong> <span class="math inline">\(H_0\)</span> : considérer les deux variables comme <strong>dépendantes</strong> = ayant une relation statistique, un lien.</li>
</ul>
</section><section id="format-des-resultats-donnés-par-avec-r" class="slide level2">
<h2>Format des resultats donnés par avec R</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regression &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span>iris<span class="op">$</span>Petal.Width)
<span class="kw">summary</span>(regression)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = iris$Petal.Length ~ iris$Petal.Width)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.33542 -0.30347 -0.02955  0.25776  1.39453 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       1.08356    0.07297   14.85   &lt;2e-16 ***
## iris$Petal.Width  2.22994    0.05140   43.39   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4782 on 148 degrees of freedom
## Multiple R-squared:  0.9271, Adjusted R-squared:  0.9266 
## F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Distribution des résidus, coefficients du modèle ajusté et leur <strong>p-value</strong> associée (ici sur un test de Student, notée <code>Pr(&gt;|t|)</code> et <span class="math inline">\(R^2\)</span>)</p>
</section><section id="bonus-critères-de-significativité-du-lien-linéaire" class="slide level2">
<h2>Bonus: Critères de significativité du lien linéaire</h2>
<p>Les <strong>résidus</strong> <span class="math inline">\(\epsilon_i\)</span> (écart entre valeur observée et valeur prédite (<span class="math inline">\(V_2 - \hat{V_2}\)</span>) par le modèle pour l'individu <span class="math inline">\(i\)</span>) doivent:</p>
<ul>
<li>être indépendants : covariance nulle ou très faible <span class="math inline">\(cov(x_i, \epsilon_i) = 0\)</span></li>
<li>être distribués selon un loi normale de moyenne nulle <span class="math inline">\(\epsilon \sim \mathscr{N}(0,\sigma_{\epsilon})\)</span></li>
<li>être distribués de façon homogène (homoscédasticité), i.e. de variance constante <span class="math inline">\(var(\epsilon_i)=\sigma_{\epsilon}^2\)</span> , indépendante de l'observation</li>
</ul>
</section><section id="bonus-evaluation-de-lindépendance-des-résidus-avec-r" class="slide level2">
<h2>Bonus: Evaluation de l'indépendance des résidus avec R</h2>
<p>Graphique de la fonction <code>acf</code>:</p>
<p>Si une barre exceptée la première dépasse la ligne en pointillés, on peut remettre en cause l'indépendance des résidus. Ici, c'est le cas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Petal.Width)
<span class="kw">acf</span>(<span class="kw">residuals</span>(modele1))</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/residualSigni3-1.png" width="576" style="display: block; margin: auto;" /></p>
</section><section id="bonusles-4-graphiques-résultats-de-la-fonction-lm" class="slide level2">
<h2>Bonus:Les 4 graphiques résultats de la fonction <code>lm</code></h2>
<p>La fonction <code>lm</code> de R et ses résultats permettent de tracer 4 graphiques pour évaluer certains des critères de significativité.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Petal.Width)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># pour avoir une matrice de graphes</span>
<span class="kw">plot</span>(modele1)</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/residualSignif-1.png" width="576" style="display: block; margin: auto;" /></p>
</section><section id="bonus-évaluer-lhomogénéité-des-résidus-avec-r" class="slide level2">
<h2>Bonus: Évaluer l'homogénéité des résidus avec R</h2>
<p>Premier graphique : pour vérifier que le nuage de points est homogène (e.g. pas de relation non-linéaire entre résidus et valeurs prédites)</p>
<p>Une éventuelle relation non-linéaire pourrait se retrouver dans les résidus(Ici : légère structure parabolique )</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Petal.Width)
<span class="kw">plot</span>(modele1,<span class="dv">1</span>)</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/residualSignif1-1.png" width="576" style="display: block; margin: auto;" /></p>
</section><section id="bonus-evaluer-la-normalité-de-la-distribution-des-résidus-avec-r" class="slide level2">
<h2>Bonus: Evaluer la normalité de la distribution des résidus avec R</h2>
<p>Le deuxième graphique &quot;Q-Q plot&quot; : pour vérifier l'<strong>hypothèse de normalité des résidus</strong>, les points doivent être proches de la bissectrice</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Petal.Width)
<span class="kw">plot</span>(modele1,<span class="dv">2</span>)</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/residualSignif2-1.png" width="576" style="display: block; margin: auto;" /></p>
</section><section id="bonus-evaluer-lhomoscédasticité-des-résidus" class="slide level2">
<h2>Bonus: Evaluer l'homoscédasticité des résidus</h2>
<p><span style="font-size:18px;"> Le troisème graphique &quot;Scale location&quot; : si les résidus sont distribués de façon homogène suivant les valeurs &quot;fittées&quot;, alors la droite est plutôt horizontale et les points sont disposés de façon homogène autour.</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Petal.Length<span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Petal.Width)
<span class="kw">plot</span>(modele1,<span class="dv">3</span>)</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/residualSignif3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><span style="font-size:18px;">Ici: légère pente mais les points sont distribués de façon relativement homogène autour de la droite.</span></p>
</section></section>
<section><section id="corrélation-de-deux-variables-quantitatives" class="titleslide slide level1"><h1>Corrélation de deux variables quantitatives</h1></section><section id="corrélation-linéaire" class="slide level2">
<h2>Corrélation (linéaire)</h2>
<p>Dans le cas d'une liaison statistique linéaire entre deux variables, on peut calculer l'«intensité» de ce lien sans nécessairement trouver les coefficients modèle linéaire : c'est la <strong>corrélation</strong></p>
<p><span class="math inline">\(cor(x,y) \in [-1;1]\)</span> entre deux variables <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> .</p>
<ul>
<li>+1 : les deux variables croissent ou décroissent conjointement</li>
<li>-1 : quand l'une des variables croît, l'autre décroît.</li>
<li>0 : pas de relation <strong>linéaire</strong> entre les deux variables</li>
</ul>
<p><font size="3">R donne le coefficient de Pearson par defaut, l'argument <code>method</code> de la fonction <code>cor()</code> permet de spécifier deux autres coefficients : Kendall et Spearman.</font></p>
</section><section id="test-de-corrélation-entre-deux-variables-avec-r" class="slide level2">
<h2>Test de corrélation entre deux variables avec R</h2>
<p>Version plus complète : c'est un <strong>test</strong>, on a plusieurs indicateurs statistiques sur ce test, notamment la <strong>p-value</strong> et <strong>l'intervalle de confiance</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(iris<span class="op">$</span>Petal.Length, iris<span class="op">$</span>Petal.Width)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  iris$Petal.Length and iris$Petal.Width
## t = 43.387, df = 148, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9490525 0.9729853
## sample estimates:
##       cor 
## 0.9628654</code></pre>
<p>Rappel : la p-value quantifie la <strong>significativité</strong> du test. En général, on considère le test significatif si elle est en dessous de 5%, soit 0.05.</p>
</section><section id="calcul-direct-du-coefficient-de-corrélation" class="slide level2">
<h2>Calcul direct du coefficient de corrélation</h2>
<p>Soient deux variables <span class="math inline">\(V_1\)</span> et <span class="math inline">\(V_2\)</span></p>
<p>Le coefficient de corrélation <span class="math inline">\(r\)</span> de <span class="math inline">\(V_1\)</span> et <span class="math inline">\(V_2\)</span> est la normalisation de la covariance par le produit des écart-types des variables</p>
<p><span class="math inline">\(r= \frac{cov(V_1,V_2)}{\sigma_{V_1}\sigma_{V_2}}\)</span></p>
<p>La covariance est la <strong>moyenne du produit des écarts à la moyenne</strong></p>
<p><span class="math inline">\(cov(V_1,V_2)= E[(V_1-E[V_1])(V_2-E[V_2])]\)</span></p>
</section><section id="matrice-de-corrélations" class="slide level2">
<h2>Matrice de corrélations</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
## Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
## Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
## Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</code></pre>
<p>Présentation des corrélations entre les variables quantitatives d'un tableau, pour tous les couples de variables.</p>
<p>La matrice de corrélation est symétrique, et sa diagonale est constituée de 1.</p>
</section><section id="sensibilité-aux-outliers" class="slide level2">
<h2>Sensibilité aux 'outliers'</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>)
Y &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>)
<span class="kw">plot</span>(X, Y, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">16</span>), <span class="dt">ylim=</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">16</span>))</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/sensitiveOut1-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(X,Y)<span class="op">$</span>estimate</code></pre></div>
<pre><code>## cor 
##   0</code></pre>
</section><section id="sensibilité-aux-outliers-1" class="slide level2">
<h2>Sensibilité aux 'outliers'</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">15</span>)
Y &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">15</span>)
<span class="kw">plot</span>(X, Y, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">16</span>), <span class="dt">ylim=</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">16</span>))</code></pre></div>
<p><img src="CoursBivariee_PC_files/figure-revealjs/sensitiveOut2-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(X,Y)<span class="op">$</span>estimate</code></pre></div>
<pre><code>##       cor 
## 0.9052224</code></pre>
</section><section id="sensibilité-aux-outliers-2" class="slide level2">
<h2>Sensibilité aux 'outliers'</h2>
<p>Outlier : observation &quot;<em>anormale</em>&quot;, par sa valeur extrème , comparée aux autres.</p>
<p>La corrélation et la régression linéaire sont très sensibles aux outliers.</p>
<p><span class="math inline">\(\rightarrow\)</span> s'interroger sur la nécessité de nettoyer/filter les données et des conséquences</p>
</section></section>
<section><section id="régression-linéaire-avec-r" class="titleslide slide level1"><h1>Régression linéaire avec R</h1></section><section id="regression-linéaire-avec-r" class="slide level2">
<h2>Regression linéaire avec R</h2>
<p>Fonction <code>lm()</code> , modèle de la forme <code>Variable_a_expliquer ~ Variable_explicative</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Width<span class="op">~</span>Petal.Length, <span class="dt">data=</span>iris)
<span class="kw">summary</span>(my_model)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Width ~ Petal.Length, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.56515 -0.12358 -0.01898  0.13288  0.64272 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.363076   0.039762  -9.131  4.7e-16 ***
## Petal.Length  0.415755   0.009582  43.387  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2065 on 148 degrees of freedom
## Multiple R-squared:  0.9271, Adjusted R-squared:  0.9266 
## F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</section><section id="que-faire-lorsque-la-relation-nest-pas-linéaire" class="slide level2">
<h2>Que faire lorsque la relation n'est pas linéaire ?</h2>
<p>Quand les deux variables sembles corrélées , de façon <strong>monotone</strong> mais <strong>non linéaire</strong>,</p>
<p><span class="math inline">\(\rightarrow\)</span> Coefficient de <strong>Spearman</strong>, basé sur le <strong>rang</strong> des individus.</p>
<center>
<span class="math inline">\(\rho = 1 - \frac{6\sum_{i=1}^{n}(rg(X_i)-rg(Y_i))^2 }{n^3 -n}\)</span>
</center>
<p>avec :</p>
<p><span class="math inline">\(rg(X_i)\)</span> le <em>rang</em> de <span class="math inline">\(X_i\)</span> (le classement de sa valeur) dans la distribution de <span class="math inline">\(X\)</span></p>
<p><span class="math inline">\(n\)</span> le nombre d'individus</p>
</section><section id="obtenir-le-coefficient-de-spearman-avec-r" class="slide level2">
<h2>Obtenir le coefficient de Spearman avec R</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Sepal.Width, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  iris$Sepal.Length and iris$Sepal.Width
## S = 656283, p-value = 0.04137
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1667777</code></pre>
<p>l'argument <code>exact</code> doit être précisé en cas de valeurs ex aequo dans les données.</p>
</section><section id="utilisation-conjointe-des-coefficients-de-pearson-et-spearman" class="slide level2">
<h2>Utilisation conjointe des coefficients de Pearson et Spearman</h2>
<p><span class="math inline">\(r\)</span> (Pearson) et <span class="math inline">\(\rho\)</span> (Spearman) sont deux moyens d'estimer la corrélation: lequel choisir ?</p>
<p>si <span class="math inline">\(r = \rho\)</span>: on garde <span class="math inline">\(r\)</span> (plus simple à interpréter)</p>
<p>si <span class="math inline">\(r &lt; \rho\)</span>: la relation est non-linéaire : prendre <span class="math inline">\(\rho\)</span></p>
<p>si <span class="math inline">\(r &gt; \rho\)</span>: il y a un biais, prendre <span class="math inline">\(\rho\)</span> (plus robuste)</p>
<p>... et toujours <strong>tracer le nuage de points</strong> pour examiner la nature de la relation.</p>
</section></section>
<section><section id="trucs-pour-linéariser-des-relations-non-linéaires" class="titleslide slide level1"><h1>&quot;trucs&quot; pour linéariser des relations non-linéaires</h1></section><section id="relation-log-linéaire" class="slide level2">
<h2>Relation log-linéaire</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/loglin-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Relation de type <span class="math inline">\(y=ax^b\)</span></p>
<p>se linéarise par <span class="math inline">\(ln(y)=aln(x) + ln(b)\)</span></p>
</section><section id="relation-géométrique-exponentielle" class="slide level2">
<h2>Relation géométrique (exponentielle)</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/expolin-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Relation de type <span class="math inline">\(y=e^{ax+b}\)</span></p>
<p>se linéarise par <span class="math inline">\(ln(y)=ax + ln(b)\)</span></p>
</section><section id="relation-logarithmique" class="slide level2">
<h2>Relation logarithmique</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/logar-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Relation de type <span class="math inline">\(y=a*ln(x)+b\)</span></p>
<p><span class="math inline">\(\rightarrow\)</span> changement de variable</p>
</section><section id="relation-logistique" class="slide level2">
<h2>Relation logistique</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/logistic-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Relation de type <span class="math inline">\(y= y_{min} * \frac{y_{max}-y_{min}}{1+e^{ax+b}}\)</span></p>
<p>se linéarise par <span class="math inline">\(ln\bigg(\frac{y_{max}-y}{y-y_{min}}\bigg)=ax+b\)</span></p>
</section></section>
<section><section id="lien-entre-deux-variables-qualitatives" class="titleslide slide level1"><h1>Lien entre deux variables qualitatives</h1></section><section id="représentation-graphique" class="slide level2">
<h2>Représentation graphique</h2>
<p>Pour deux variables qualitatives, on ne peut pas produire de nuages de points, ni de droite de régression.</p>
<p><span class="math inline">\(\rightarrow\)</span> on peut représenter la table de contingence (cf. fonction <code>mosaicplot</code> de R).</p>
<p><img src="CoursBivariee_PC_files/figure-revealjs/mosaic-1.png" width="576" style="display: block; margin: auto;" /></p>
</section><section id="test-statistique-dit-du-chi-2-ou-chi-carré" class="slide level2">
<h2>Test statistique dit du &quot;Chi 2&quot; ou &quot;Chi carré&quot;</h2>
<p>Le test du <span class="math inline">\(\chi ^2\)</span> est un test d'indépendance, il mesure l'<strong>écart</strong>, la différence, entre deux distributions de <strong>variables qualitatives</strong></p>
<p>Il répond à la question : &quot;Existe-t-il un lien statistique entre deux séries de valeurs qualitatives&quot;</p>
<p>(La réponse est de type OUI/NON , le <span class="math inline">\(\chi^2\)</span> ne donne pas l'<strong>intensité</strong> du lien)</p>
</section><section id="test-statistique-dit-du-chi-2-ou-chi-carré-1" class="slide level2">
<h2>Test statistique dit du &quot;Chi 2&quot; ou &quot;Chi carré&quot;</h2>
<ul>
<li>Hypothèse nulle <span class="math inline">\(H_0\)</span> : les deux distributions sont indépendantes.</li>
<li>«faire le test» permet de conserver ou de rejeter cette hypothèse</li>
</ul>
</section><section id="principe-du-chi-2" class="slide level2">
<h2>Principe du Chi 2</h2>
<ul>
<li>On génère une <strong>population théorique</strong> à laquelle on va comparer la <strong>population observée</strong> en considérant leurs <strong>distribution</strong>.</li>
<li>Cette distribution théorique reflête ce qui se passerait si on suppose que <span class="math inline">\(H_0\)</span> est vraie</li>
<li>Avec cette comparaison, on pourra rejeter ou conserver l'hypothèse nulle.</li>
</ul>
<p>La construction de cette distribution se fait à partir du <strong>tableau de contingence</strong></p>
</section><section id="tableau-de-contingence" class="slide level2">
<h2>Tableau de contingence</h2>
<p>C'est un tableau à double entrée qui croise deux <strong>variables qualitatives</strong>.</p>
<p>Dans une case on trouve l'<strong>effectif</strong> (= le nombre) des individus caractérisés par la conjonction des modalités en ligne et en colonnes.</p>
<p>Exemple sur des formes géométriques de couleurs :</p>
<p><span class="math display">\[\begin{array}{c|c|c}
   &amp; blanc &amp; noir \\ 
   \hline
carré &amp;  22 &amp;   12 \\ 
  \hline
  rond &amp;   10 &amp;  30 \\ 
    \hline
  triangle &amp;  26 &amp;   5 \\ 
\end{array}\]</span></p>
<p>Dans R : fonction <code>table()</code></p>
</section><section id="construction-de-la-distribution-théorique." class="slide level2">
<h2>Construction de la distribution théorique.</h2>
<p>On commence par sommer les effectifs selon les modalités (en ligne et en colonne)</p>
<p><span class="math display">\[\begin{array}{c|c|c|c}
   &amp; blanc &amp; noir &amp; \texttt{total}\\ 
   \hline
carré &amp;  22 &amp;   12 &amp; 34\\ 
  \hline
  rond &amp;   10 &amp;  30 &amp;  40  \\ 
    \hline
  triangle &amp;  26 &amp;   5 &amp;  31\\
  \hline
  \texttt{total} &amp; 58 &amp; 47 &amp; 105
  \end{array}\]</span></p>
<p>On appelle les sommes en lignes et en colonnes <strong>sommes marginales</strong>, elles sont mises dans les &quot;marges&quot; du tableau.</p>
</section><section id="construction-de-la-distribution-théorique" class="slide level2">
<h2>Construction de la distribution théorique</h2>
<p>En divisant par la taille de la population, on obtient les <strong>fréquences observées</strong>.</p>
<p><span class="math display">\[\begin{array}{c|c|c|c}
   &amp; blanc &amp; noir &amp; \texttt{total}\\ 
   \hline
carré &amp;  0.20952381&amp;  0.11428571 &amp;  0.3238095\\ 
  \hline
  rond &amp;    0.09523810 &amp; 0.28571429 &amp; 0.3809524  \\ 
    \hline
  triangle &amp; 0.24761905 &amp; 0.04761905 &amp;   0.2952381\\
  \hline
  \texttt{total} &amp;  0.552381 &amp; 0.447619 &amp; 1
  \end{array}\]</span></p>
<p><font size="4"> On obtient les <strong>pourcentages de l'effectif</strong> dans les cases du tableau.</p>
<p>C'est également la <strong>probabilité</strong> , qu'un individu de la <strong>population observée</strong> soit caractérisé par les modalités en ligne et en colonne. </font></p>
</section><section id="construction-de-la-distribution-théorique-1" class="slide level2">
<h2>Construction de la distribution théorique</h2>
<p><span class="math display">\[\begin{array}{c|c|c|c}
   &amp; blanc &amp; noir &amp; \texttt{total}\\ 
   \hline
carré &amp;  0.20952381&amp;  0.11428571 &amp;  \textbf{0.3238095}\\ 
  \hline
  rond &amp;    0.09523810 &amp; 0.28571429 &amp; \textbf{0.3809524}  \\ 
    \hline
  triangle &amp; 0.24761905 &amp; 0.04761905 &amp;   \textbf{0.2952381}\\
  \hline
  \texttt{total} &amp;  \textbf{0.552381} &amp; \textbf{0.447619} &amp; 1
  \end{array}\]</span></p>
<p>De la même façon, les <strong>fréquences marginales</strong> (marges divisées par la taille de la pop.), donnent la <strong>probabilité</strong> d'observer un individu de la modalité correspondant à la ligne ou à la colonne considérée.</p>
<p><font size="4"> Exemple : dans cette population , j'ai 29.5% de chances de tirer un triangle, et 55% de chances de tirer une pièce blanche. </font></p>
</section><section id="construction-de-la-distribution-théorique-2" class="slide level2">
<h2>Construction de la distribution théorique</h2>
<p>Rappel : Probabilité conjointe de deux évènements <span class="math inline">\(A\)</span> et <span class="math inline">\(B\)</span> <strong>indépendants</strong><br />
<span class="math inline">\(P(A \cap B) = P(A) \times P(B)\)</span></p>
<p>À partir des <strong>fréquences marginales</strong> précédentes, on obtient pour chaque couple de modalités, la probabilité <strong>théorique</strong>, celle qui suppose <span class="math inline">\(H_0\)</span>, par un simple <strong>produit</strong>.</p>
<p><font size="4"> Exemple : Si <span class="math inline">\(H_0\)</span> est vraie, la probabilité d'observer un triangle noir est donnée par:</p>
<p><span class="math inline">\(P(triangle \cap noir) = P(triangle) \times P(noir)\)</span></p>
<p><span class="math inline">\(P(triangle \cap noir) =0.447619 \times 0.2952381 = 0.1321542\)</span></p>
<p>La probabilité théorique d'observer un triangle noir est de 13,2%<br />
</font></p>
</section><section id="construction-de-la-distribution-théorique-3" class="slide level2">
<h2>Construction de la distribution théorique</h2>
<p>On crée un second tableau, dont chaque case vaut le produit des fréquences marginales calculées sur le tableau des observations.</p>
<p><span class="math display">\[\begin{array}{c|c|c|c}
   &amp; blanc &amp; noir &amp; \texttt{total}\\ 
   \hline
carré &amp;  0.1788662 &amp;   0.1449433 &amp;  \textbf{0.3238095}\\ 
  \hline
  rond &amp;    0.2104309 &amp;0.1705215 &amp; \textbf{0.3809524}  \\ 
    \hline
  triangle &amp;  0.1630839 &amp; 0.1321542 &amp;   \textbf{0.2952381}\\
  \hline
  \texttt{total} &amp;  \textbf{0.552381} &amp; \textbf{0.447619} &amp; 1
  \end{array}\]</span></p>
<p>C'est le tableau des <strong>fréquences théoriques</strong>.</p>
</section><section id="tableau-des-effectifs-théoriques" class="slide level2">
<h2>Tableau des effectifs théoriques</h2>
<p>On l'obtient en multipliant les fréquences théoriques par la taille de la population observée (ici 105)</p>
<p><span class="math display">\[\begin{array}{c|c|c}
   &amp; blanc &amp; noir \\ 
   \hline
carré &amp;  18.78095 &amp;  15.21905 \\ 
  \hline
  rond &amp;   22.09524 &amp; 17.90476    \\ 
    \hline
  triangle &amp; 17.12381 &amp; 13.87619   \\
  \end{array}\]</span></p>
<p><font size="4"> N.B. Il n'est pas nécessaire d'arrondir les effectifs théoriques </font></p>
</section><section id="calcul-du-chi-2" class="slide level2">
<h2>Calcul du Chi 2</h2>
<p>C'est la somme, pour chaque case du tableau de contingence (i.e. pour chaque couple de modalités), des écarts carrés entre effectif observé et effectif théorique**, divisés par l'effectif théorique.</p>
<p>Soient <span class="math inline">\(T^{obs}\)</span> le tableau des effectifs observés, <span class="math inline">\(T^{theo}\)</span> le tableau des effectifs théoriques,</p>
<center>
<span class="math inline">\(\chi^2 = \sum_{i,j} \frac{( T^{obs}_{i,j} - T^{theo}_{i,j})^2}{T^{obs}_{i,j}}\)</span>
</center>
<p>ici : <span class="math inline">\(\chi^2 = 26.30329\)</span></p>
</section><section id="interprétation-du-chi-2" class="slide level2">
<h2>Interprétation du Chi 2</h2>
<p>Il faut comparé la valeur du <span class="math inline">\(\chi^2\)</span> calculée avec la <strong>valeur critique</strong> qu'on trouve dans une <strong>table de loi de Student</strong> (ou table de loi du chi 2).</p>
<p>C'est un tableau à double entrée : une <strong>valeur de quantile</strong>, et un <strong>degré de liberté</strong>.</p>
<p>On peut considérer que la valeur de quantile est le pourcentage d'erreur qu'on s'autorise de faire. On prend souvent <strong>5%</strong> : la colonne 1-0.05 = 0.95</p>
<p>Le degré de liberté est obtenu en calculant la valeur <span class="math inline">\((nb\_lignes - 1)*(nb\_colonnes -1)\)</span>.</p>
<p>Dans notre exemple , le degré de liberté est 2*1 = 2</p>
</section><section id="table-de-loi-de-student" class="slide level2">
<h2>Table de loi de Student</h2>
<center>
<img src="table.loi.de.student.png", width=100%></img>
</center>
</section><section id="interprétation-du-chi-2-1" class="slide level2">
<h2>Interprétation du Chi 2</h2>
<p>D'après le tableau de la loi de Student , la valeur critique pour un test avec 5% de chances de se tromper est un degré de liberté de 2 vaut 4.303.</p>
<p>Si la valeur calculée du <span class="math inline">\(\chi^2\)</span> est <strong>supérieure</strong> à la valeur critique, on <strong>rejette</strong> <span class="math inline">\(H_0\)</span>.</p>
<p>Pour notre exemple: On rejette <span class="math inline">\(H_0\)</span>, i.e. les deux variables sont <strong>dépendantes</strong>, car <span class="math inline">\(\chi ^2 \approx 26 &gt; 4.303\)</span></p>
<p>Interprétation: «la forme est liée à la couleur dans cette population, nous pouvons l'affirmer avec un risque d'erreur d'au moins 5%»</p>
</section><section id="les-étapes-du-chi-2" class="slide level2">
<h2>Les étapes du <span class="math inline">\(\chi ^2\)</span></h2>
<ul>
<li>Tableau de contingence</li>
<li>Sommes marginales
<ul>
<li>Calcul des fréquences observées</li>
<li>Calcul des fréquences théoriques</li>
</ul></li>
<li>Tableau d'effectifs théoriques</li>
<li>Calcul de la valeur du test</li>
<li>Comparaison avec les valeurs de la table de Student</li>
</ul>
</section></section>
<section><section id="lien-entre-une-variable-qualitative-et-une-variable-quantitative." class="titleslide slide level1"><h1>Lien entre une variable qualitative et une variable quantitative.</h1></section><section id="représentation-graphique." class="slide level2">
<h2>Représentation graphique.</h2>
<p>Pas de moyen <strong>simple</strong> de calculer le lien entre une variable qualitative et une variable quantitative.</p>
<ul>
<li>corrélation de rang</li>
<li>régression logistique</li>
<li>analyse de la variance (ANOVA)</li>
</ul>
<p><span class="math inline">\(\implies\)</span> Alors on fait un graphique !</p>
<p>La variable qualitative sert de <strong>catégorie</strong>, on fait varier la représentation graphique de la variable quantitative suivant cette catégorie.</p>
<p>2 possibilités :</p>
<ul>
<li>boîtes à moustaches</li>
<li>superposition d' histogrammes / densités</li>
</ul>
</section><section id="les-boîtes-à-moustaches" class="slide level2">
<h2>Les boîtes à moustaches</h2>
<p>&quot;Boîte à moustaches&quot;, aussi appellées &quot;boxplot&quot;, montre les quartiles d'une variable</p>
<p>Quartile = «quantile de 4», valeurs qui séparent une variable quantitative en quarts, i.e. paquets d'un quart de l'effectif</p>
<ul>
<li>Premier quartile : sépare les 25% inférieurs des valeurs</li>
<li>Second quartile : <strong>mediane</strong>, sépare les 50% inférieurs des valeurs</li>
<li>troisième quartile : sépare les 75% inférieurs des valeurs</li>
</ul>
<p>Dans R, fonction <code>quantile</code></p>
</section><section id="boxplot-et-distribution" class="slide level2">
<h2>Boxplot et Distribution</h2>
<p><img src="CoursBivariee_PC_files/figure-revealjs/unnamed-chunk-1-1.png" width="768" style="display: block; margin: auto;" /></p>
</section><section id="boxplot-par-catégories" class="slide level2">
<h2>Boxplot par catégories</h2>
<p>Principe : on trace un boxplot par modalité de la variable qualitative.</p>
<p>E.g. : consommation de véhicules par type (dataset <code>mpg</code> de R)</p>
<p><img src="CoursBivariee_PC_files/figure-revealjs/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;" /></p>
</section></section>
<section><section id="références-supplémentaires" class="titleslide slide level1"><h1>Références supplémentaires</h1></section><section id="refs" class="slide level2">
<h2>Refs</h2>
<p>Cours complet sur les modèles linéaires : [<a href="https://www.math.univ-toulouse.fr/~barthe/M1modlin/poly.pdf" class="uri">https://www.math.univ-toulouse.fr/~barthe/M1modlin/poly.pdf</a>]</p>
<p>Interprétation des graphique de <code>lm</code> en R : [<a href="https://data.library.virginia.edu/diagnostic-plots/" class="uri">https://data.library.virginia.edu/diagnostic-plots/</a>]</p>
</section></section>
    </div>
  </div>

  <script src="CoursBivariee_PC_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="CoursBivariee_PC_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: true,
        // Opens links in an iframe preview overlay
        previewLinks: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        // Optional reveal.js plugins
        dependencies: [
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
